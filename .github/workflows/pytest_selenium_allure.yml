name: Python tests using allure example

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */4 * * *'

jobs:
  selenium_tests:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: 🐍 Step 1 - Set up Python 3.10
        uses: actions/setup-python@v3
        with:
          python-version: '3.10'
      - name: 🔗 Step 2 - Install dependencies
        run: |
        python -m pip install --upgrade pip
        pip install flake8 pytest
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
        working-directory: {name of your project root here}
      - name: 📂 Step 3 - Create a temp artifact folder named `output`
        run: |
          mkdir output
      - name: 🦊 Step 4 - Run Firefox tests and generate Allure folder inside `output` folder
        run: |
          pytest -vs tests/ --browser firefox --alluredir={provide the directory where you want the allure folder to go}
        working-directory: {name of your project root here}
      - name: 📊 Step 5 - Collect Allure files and generate allure-report folder
        run: |
          allure generate output/
      - name: 🎁 Step 6 - Publishing Allure artifact to GitHub Actions
        uses: actions/upload-artifact@v2
        with:
          name: allure-report
          path: allure-report